/**
 * Add animated cat sprites to adaptive tour steps.
 *
 * @module     local_adaptive_course_audit/tour_sprites
 * @copyright  2025 Moodle HQ
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_adaptive_course_audit/tour_sprites",["jquery","core/config"],(function($,coreConfig){const watchForSteps=spriteConfig=>{const processedNodes=new WeakSet,decorate=node=>{processedNodes.has(node)||(processedNodes.add(node),((stepContentEl,spriteConfig)=>{const stepContent=$(stepContentEl);stepContent.addClass("local-aca-tour-animated"),stepContent.find(".".concat("local-aca-tour-sprite")).remove();const sprite=document.createElement("div");sprite.className="".concat("local-aca-tour-sprite"," ").concat("local-aca-tour-sprite","--").concat(spriteConfig.variant),sprite.style.backgroundImage="url('".concat(spriteConfig.url,"')"),stepContent.append(sprite)})(node,spriteConfig.nextVariant()))};document.querySelectorAll('[data-flexitour="container"] .modal-content').forEach((node=>decorate(node)));new MutationObserver((mutations=>{try{mutations.forEach((mutation=>{mutation.addedNodes.forEach((node=>{if(!(node instanceof HTMLElement))return;if((node=>node instanceof HTMLElement&&node.matches('[data-flexitour="container"] .modal-content'))(node))return void decorate(node);(node.querySelectorAll?node.querySelectorAll('[data-flexitour="container"] .modal-content'):[]).forEach((nestedNode=>decorate(nestedNode)))}))}))}catch(error){window.console.error("Adaptive course audit sprite observer error",error)}})).observe(document.body,{childList:!0,subtree:!0})};return{init:config=>{try{const resolvedConfig=config&&config.talkSpriteUrl&&config.winkSpriteUrl?config:(()=>{const wwwroot=coreConfig&&coreConfig.wwwroot?coreConfig.wwwroot:window.M&&window.M.cfg&&window.M.cfg.wwwroot?window.M.cfg.wwwroot:"";return wwwroot?{talkSpriteUrl:"".concat(wwwroot,"/local/adaptive_course_audit/pix/miau_talk_sprite.png"),winkSpriteUrl:"".concat(wwwroot,"/local/adaptive_course_audit/pix/miau_wink_sprite.png")}:null})();if(!resolvedConfig||!resolvedConfig.talkSpriteUrl||!resolvedConfig.winkSpriteUrl)return void window.console.error("Adaptive course audit sprites missing URLs");const spriteConfig=((talkSprite,winkSprite)=>{const variants=[{variant:"talk",url:talkSprite},{variant:"wink",url:winkSprite}];let index=0;return{nextVariant:()=>{const choice=variants[index%variants.length];return index++,choice}}})(resolvedConfig.talkSpriteUrl,resolvedConfig.winkSpriteUrl);watchForSteps(spriteConfig)}catch(error){window.console.error("Adaptive course audit sprite initialisation failed",error)}}}}));

//# sourceMappingURL=tour_sprites.min.js.map